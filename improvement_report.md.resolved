# รายงานการปรับปรุงระบบ Tracking สำหรับ Banner

เอกสารนี้สรุปที่มา ปัญหา ความต้องการ และแผนการดำเนินงานสำหรับการปรับปรุงระบบ Tracking บนหน้าบทความ เพื่อให้สามารถแยกแยะประสิทธิภาพของ Banner แต่ละตำแหน่งได้

## 1. ปัญหาและอุปสรรค (Problems & Obstacles)
*   **ไม่ทราบแหล่งที่มาที่ชัดเจน:** ลิงก์ทั้งหมดในหน้าเว็บส่งค่า `typedealer` เดียวกัน (เช่น `organic_article-slug`) ทำให้ฝ่ายการตลาดไม่ทราบว่าลูกค้าคลิกมาจากจุดไหนของหน้าเว็บ (Banner ตรงกลาง, ด้านล่าง หรือ Sidebar)
*   **การจัดการลิงก์ยุ่งยาก:** หากต้องมานั่งแก้ลิงก์ใน HTML ทุกจุดให้ต่างกัน จะทำให้โค้ด HTML สกปรก ดูแลรักษายาก และเสี่ยงต่อการผิดพลาดเมื่อมีการเปลี่ยนรูปภาพหรือเนื้อหา
*   **ข้อจำกัดเรื่อง SEO:** การใส่ Parameter ยาวๆ หรือแปลกปลอมเข้าไปใน `href` โดยตรงอาจส่งผลกระทบต่อความสะอาดขอ URL และ SEO ในบางกรณี

## 2. ความต้องการ (Requirements)
*   **แยกแยะตำแหน่ง Banner:** ต้องการให้ค่า `typedealer` ระบุได้ว่าคลิกมาจาก Banner ตำแหน่งใด (Middle, Bottom, Right)
*   **ข้อมูลครบถ้วน:** ค่า `typedealer` ต้องยังคงเก็บข้อมูลเดิม (Article Slug) ไว้ และเพียงแค่ "ต่อท้าย" ด้วยตำแหน่งเท่านั้น
*   **ความยืดหยุ่น:** สามารถเปลี่ยนรูปภาพ Banner ได้ตลอดเวลาโดยไม่ต้องแก้โค้ดส่วนอื่น
*   **ไม่กระทบระบบเดิม:** ระบบต้องทำงานร่วมกับโค้ด `organic` เดิมที่มีอยู่ได้

## 3. ข้อจำกัด (Constraints)
*   **ห้ามเพิ่มตัวแปรใหม่:** ห้ามสร้าง parameter ใหม่ (เช่น `?banner_pos=...`) ให้ใช้ `typedealer` ตัวเดิมเท่านั้น
*   **URL ใน HTML ต้องปกติ:** ใน Source Code HTML ลิงก์ต้องเป็น clean URL (`form-mock.html`) เท่านั้น ห้ามใส่ Query String ฝังไว้
*   **แก้ไขที่ JS เท่านั้น:** การเปลี่ยนแปลง logic ทั้งหมดต้องอยู่ที่ JavaScript เพื่อไม่ให้กระทบโครงสร้างหน้าเว็บ

## 4. แผนการปรับปรุง (Improvement Plan)

### แนวทางการแก้ไข (Solution Strategy)
ใช้ **Event Delegation** และ **DOM Traversal** ใน JavaScript ([tracking.js](file:///Users/weerachitbuaim/Documents/TEST_WEB/tracking.js)) เพื่อดักจับการคลิกและตรวจสอบตำแหน่งของลิงก์ก่อนที่จะเปลี่ยนหน้า

### รายละเอียดการทำงาน (Technical Details)
1.  **คงสถานะลิงก์ปกติ:** ในไฟล์ [index.html](file:///Users/weerachitbuaim/Documents/TEST_WEB/index.html) ปล่อยลิงก์ให้เป็นปกติ (`<a href="...">`) และกำหนด Class บ่งบอกตำแหน่งให้ Container (Parent Element) แทน เช่น:
    *   `.banner-middle`
    *   `.banner-bottom`
    *   `.sticky-banner` (สำหรับ Sidebar)
    
2.  **Logic ใน [tracking.js](file:///Users/weerachitbuaim/Documents/TEST_WEB/tracking.js):**
    *   ดักจับ Event `click` บนลิงก์เป้าหมาย
    *   สร้างค่าเริ่มเต้น `trackingValue = organic_{slug}`
    *   ใช้คำสั่ง `closest('.classname')` เพื่อตรวจสอบว่าลิงก์ที่ถูกกด อยู่ภายใต้ Container ไหน
    *   **ถ้าอยู่ Middle:** ต่อท้ายด้วย `_banner_middle`
    *   **ถ้าอยู่ Bottom:** ต่อท้ายด้วย `_banner_bottom`
    *   **ถ้าอยู่ Sidebar:** ต่อท้ายด้วย `_banner_right`
    *   **ถ้าเป็น Text Link:** ไม่ต่อท้ายอะไร

3.  **การตรวจสอบ (Verification):**
    *   ทดสอบคลิกจริงในทุกตำแหน่ง เพื่อยืนยันว่า URL ปลายทางได้รับพารามิเตอร์ที่ถูกต้องตามตำแหน่งที่กำหนด

### ประโยชน์ที่ได้รับ
*   **Marketing:** ได้ข้อมูลละเอียดขึ้น รู้ว่า Banner ตำแหน่งไหน Work ที่สุด
*   **Developer:** ดูแลรักษาง่าย เปลี่ยนรูปภาพได้อิสระ โค้ด HTML สะอาด
*   **User/SEO:** URL เริ่มต้นดูสะอาดตา และทำงานถูกต้องแม่นยำ
